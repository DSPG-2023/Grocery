```{r}
library(ggplot2)
library(plotly)
library(readxl)
library(dplyr)
```

# Pathing

```{r}
#'*File Directory*
path <- Sys.getenv("SalesGenie")
excel_file <- "salesgenie_dollar_stores.xlsx"
excel_file_1<-"salesgenie_all_grocery.xlsx"
excel_file_2<-"salesgenie_large_chain_grocery_stores.xlsx"
dollar_store_data <- read_excel(file.path(path, excel_file))
grocery_store_data<-read_excel(file.path(path,excel_file_1))
chain_grocery_store_data<-read_excel(file.path(path,excel_file_2))
```

```{r}
p <- ggplot(data = dollar_store_data, aes(x = Company_Name, fill = Location_Sales_Volume_Range)) +
            geom_bar(position = "dodge")+
  ggtitle("Location Sales Volume distribution") +
  xlab("Dollar Store Chain Name") + ylab("Number of Stores")
ggplotly(p)
```

```{r}
p <- ggplot(data = dollar_store_data, aes(x = Company_Name, fill = Location_Sales_Volume_Range))+
  geom_bar()+
  ggtitle("Location Sales Volume distribution") +
  xlab("Dollar Store Chain Name") + ylab("Number of Stores")
ggplotly(p)%>% 
  layout(barmode = "stack")
```

```{r}
companyname_by_count <- ggplot(data = dollar_store_data, aes(x = Company_Name)) +
            geom_bar(position = "dodge")+
  ggtitle("Dollar Store Distribution by Store Name") +
  xlab("Store Name") + ylab("Number of Stores")
ggplotly(companyname_by_count)
```
```{r}
companyname_by_count_google <- ggplot(data = Google_Places_DollarStores, aes(x = name)) +
            geom_bar(position = "dodge")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))+
  ggtitle("Dollar Store Distribution by Chain Name") +
  xlab("Chain Name") + ylab("Number of Stores")
ggplotly(companyname_by_count_google)
  
```


```{r}
num_dollar_stores<-dollar_store_data%>%
ggplot(aes(x = Mailing_City)) +
            geom_bar(position = "dodge")+

  theme(axis.text.x = element_text(angle = 90, hjust = 1))+
  ggtitle("Dollar Store Distribution by Mailing City") +
  xlab("Mailing City") + ylab("Number of Stores")
ggplotly(num_dollar_stores)
```


```{r}

num_dollar_stores <- dollar_store_data %>%
  group_by(Mailing_City) %>%
  summarize(count = n()) %>%
  filter(count > 1) %>%
  ggplot(aes(x = Mailing_City, y = count)) +
  geom_bar(stat = "identity", position = "dodge") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))+
  ggtitle("Dollar Store Distribution by Mailing City") +
  xlab("Mailing City") + ylab("Number of Stores")

ggplotly(num_dollar_stores)
```

```{r}
g <- ggplot(data = chain_grocery_store_data, aes(x = Company_Name, fill = Location_Sales_Volume_Range)) +
            geom_bar(position = "dodge")+
  ggtitle("Location Sales Volume distribution for Chain Grocery Stores") +
  xlab("Grocery Store Chain Name") + ylab("Number of Stores")+
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplotly(g)
```
#TODO: Arrange the x axis cateories in ascending order.

```{r}
sales_chain_grocery <- ggplot(data = chain_grocery_store_data, aes(x = Location_Sales_Volume_Range, fill = Company_Name)) +
            geom_bar(position = "stack")+
  ggtitle("Location Sales Volume distribution for Chain Grocery Stores") +
  xlab("Sales Volume Range") + ylab("Number of Stores")+
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplotly(sales_chain_grocery)
```

```{r}
sales_chain_grocery_dodge <- ggplot(data = chain_grocery_store_data, aes(x = Location_Sales_Volume_Range, fill = Company_Name)) +
            geom_bar(position = "dodge")+
  ggtitle("Location Sales Volume distribution for Chain Grocery Stores") +
  xlab("Sales Volume Range") + ylab("Number of Stores")+
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplotly(sales_chain_grocery_dodge)
```


```{r}
num_grocery_stores <- grocery_store_data %>%
  group_by(Mailing_City) %>%
  summarize(count = n()) %>%
  filter(count > 2) %>%
  ggplot(aes(x = Mailing_City, y = count)) +
  geom_bar(stat = "identity", position = "dodge") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))+
  ggtitle("Grocery Store Distribution by Mailing City") +
  xlab("Mailing City") + ylab("Number of Stores")

ggplotly(num_grocery_stores)
```

```{r}
num_chain_grocery_stores <- chain_grocery_store_data %>%
  group_by(Mailing_City) %>%
  summarize(count = n()) %>%
  filter(count > 1) %>%
  ggplot(aes(x = Mailing_City, y = count)) +
  geom_bar(stat = "identity", position = "dodge") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))+
  ggtitle("Grocery Chain Store Distribution by Mailing City") +
  xlab("Mailing City") + ylab("Number of Stores")

ggplotly(num_chain_grocery_stores)
```

```{r}
non_chain_grocery_store_data<-anti_join(grocery_store_data, chain_grocery_store_data)
```
```{r}
num_chain_grocery_stores <- non_chain_grocery_store_data %>%
  group_by(Mailing_City) %>%
  summarize(count = n()) %>%
  filter(count > 1) %>%
  ggplot(aes(x = Mailing_City, y = count)) +
  geom_bar(stat = "identity", position = "dodge") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))+
  ggtitle("Non Chain Grocery Store Distribution by Mailing City") +
  xlab("Mailing City") + ylab("Number of Stores")

ggplotly(num_chain_grocery_stores)
```

```{r}
sales_non_chain_grocery <- ggplot(data = non_chain_grocery_store_data, aes(x = Location_Sales_Volume_Range)) +
            geom_bar(position = "stack")+
  ggtitle("Location Sales Volume distribution for non Chain Grocery Stores") +
  xlab("Sales Volume Range") + ylab("Number of Stores")+
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplotly(sales_non_chain_grocery)
```

```{r}

```

