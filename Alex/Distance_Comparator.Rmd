```{r}
library(dplyr)
```
```{r}
#This is the DF from the Google API call. Can be found in Harun/StoresOutputAPI.rmd
df_places_grocery
head(df_geocode)
```
```{r}
#Algorithm:
#four variables, nearest NESW
#for loop 
#four if else statements, compares lat long to origin
#check if distance is smaller than the nearest point in that direction
#how to deal with no stores in quadrant



#Creates a new dataframe with the Lat, Long, and Name columns
#This step is completely unnecessary, but the original DF
#had awful column names and I didn't want to have to look at all 
#the other columns
api_stores <- data.frame( Name = df_places_grocery$name, 
                          Lat = df_places_grocery$geometry$location$lat,
                          Long = df_places_grocery$geometry$location$lng)

View(api_stores)

#Defines euclidean distance function
euclidean <- function(a, b) sqrt(sum((a - b)^2))


api_stores %>% mutate(Distance = c(euclidean(a <- c(Lat, Long), b <- c(df_geocode$lat, df_geocode$lng))))
  
```

```{r}
origin_var = c(df_geocode$lat, df_geocode$lng)
end_var = matrix(c(api_stores$Lat, api_stores$Long), ncol = 2)

euc_test <- function(origin = origin_var, end = end_var) {
  sqrt(sum((end - origin)^2)) 
}

distance_vector <- apply(end_var, 1, euc_test)
```

```{r}
cbind(end_var, distance_vector)
```


```{r}
Dist_Test <- Calculate_Distance(api_stores, 
                   origin = c(df_geocode$lat, df_geocode$lng),  
                   end = c(api_stores$Lat, api_stores$Long))
```




